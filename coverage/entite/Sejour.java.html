<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Sejour.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">roar</a> &gt; <a href="index.source.html" class="el_package">entite</a> &gt; <span class="el_source">Sejour.java</span></div><h1>Sejour.java</h1><pre class="source lang-java linenums">package entite;

import java.time.LocalDate;
import java.time.LocalDateTime;
import java.time.temporal.ChronoUnit;

/**
 * Represents a patient's stay at the medical facility
 * This class matches the sejour table in the database:
 * - id
 * - dossier_medicale_id (DossierMedicale reference)
 * - date_entree
 * - date_sortie
 * - type_sejour
 * - frais_sejour
 * - moyen_paiement
 * - statut_paiement
 * - prix_extras
 */
public class Sejour {

    /*@ spec_public @*/ private int id;
    /*@ spec_public nullable @*/ private LocalDateTime dateEntree;
    /*@ spec_public nullable @*/ private LocalDateTime dateSortie;
    /*@ spec_public nullable @*/ private String typeSejour;
    /*@ spec_public @*/ private double fraisSejour;
    /*@ spec_public nullable @*/ private String moyenPaiement;
    /*@ spec_public nullable @*/ private String statutPaiement;
    /*@ spec_public @*/ private double prixExtras;
    /*@ spec_public nullable @*/ private DossierMedicale dossierMedicale;  // corresponds to dossier_medicale_id in SQL
    
    // These fields don't exist in the database and should be marked as transient
    // so they aren't involved in database operations
    /*@ spec_public nullable @*/ private transient String chambre;  // Not in database
    /*@ spec_public nullable @*/ private transient String notes;    // Not in database
    
    /*@ public invariant id &gt;= 0; @*/
    /*@ public invariant fraisSejour &gt;= 0.0; @*/
    /*@ public invariant prixExtras &gt;= 0.0; @*/

    /*@ 
      @ ensures fraisSejour == 0.0;
      @ ensures prixExtras == 0.0;
      @ ensures statutPaiement != null &amp;&amp; statutPaiement.equals(&quot;En attente&quot;);
      @*/
    // Default constructor
<span class="fc" id="L47">    public Sejour() {</span>
        // Initialize default values
<span class="fc" id="L49">        this.fraisSejour = 0.0;</span>
<span class="fc" id="L50">        this.prixExtras = 0.0;</span>
<span class="fc" id="L51">        this.statutPaiement = &quot;En attente&quot;;</span>
<span class="fc" id="L52">    }</span>
    
    /*@ 
      @ requires fraisSejour &gt;= 0.0;
      @ requires prixExtras &gt;= 0.0;
      @ 
      @ ensures this.fraisSejour == fraisSejour;
      @ ensures this.prixExtras == prixExtras;
      @ ensures this.dateEntree == dateEntree;
      @ ensures this.dateSortie == dateSortie;
      @*/
    // Constructor with all fields that exist in the database
    public Sejour(LocalDateTime dateEntree, LocalDateTime dateSortie, String typeSejour, 
            double fraisSejour, String moyenPaiement, String statutPaiement, double prixExtras, 
<span class="fc" id="L66">            DossierMedicale dossierMedicale) {</span>
<span class="fc" id="L67">        this.dateEntree = dateEntree;</span>
<span class="fc" id="L68">        this.dateSortie = dateSortie;</span>
<span class="fc" id="L69">        this.typeSejour = typeSejour;</span>
<span class="fc" id="L70">        this.fraisSejour = fraisSejour;</span>
<span class="fc" id="L71">        this.moyenPaiement = moyenPaiement;</span>
<span class="fc" id="L72">        this.statutPaiement = statutPaiement;</span>
<span class="fc" id="L73">        this.prixExtras = prixExtras;</span>
<span class="fc" id="L74">        this.dossierMedicale = dossierMedicale;</span>
<span class="fc" id="L75">    }</span>
    
    // Getters and Setters

    /*@ pure @*/
    public int getId() {
<span class="fc" id="L81">        return id;</span>
    }
    
    /*@ requires id &gt;= 0; assignable this.id; ensures this.id == id; @*/
    public void setId(int id) {
<span class="fc" id="L86">        this.id = id;</span>
<span class="fc" id="L87">    }</span>
    
    /*@ pure @*/
    public LocalDateTime getDateEntree() {
<span class="fc" id="L91">        return dateEntree;</span>
    }
    
    public void setDateEntree(LocalDateTime dateEntree) {
<span class="fc" id="L95">        this.dateEntree = dateEntree;</span>
<span class="fc" id="L96">    }</span>
    
    /*@ pure @*/
    public LocalDateTime getDateSortie() {
<span class="fc" id="L100">        return dateSortie;</span>
    }
    
    public void setDateSortie(LocalDateTime dateSortie) {
<span class="fc" id="L104">        this.dateSortie = dateSortie;</span>
<span class="fc" id="L105">    }</span>
    
    /*@ pure @*/
    public String getTypeSejour() {
<span class="fc" id="L109">        return typeSejour;</span>
    }
    
    public void setTypeSejour(String typeSejour) {
<span class="fc" id="L113">        this.typeSejour = typeSejour;</span>
<span class="fc" id="L114">    }</span>
    
    /*@ pure @*/
    public double getFraisSejour() {
<span class="fc" id="L118">        return fraisSejour;</span>
    }
    
    /*@ 
      @ requires fraisSejour &gt;= 0.0;
      @ assignable this.fraisSejour;
      @ ensures this.fraisSejour == fraisSejour;
      @*/
    public void setFraisSejour(double fraisSejour) {
<span class="fc" id="L127">        this.fraisSejour = fraisSejour;</span>
<span class="fc" id="L128">    }</span>
    
    /*@ pure @*/
    public String getMoyenPaiement() {
<span class="fc" id="L132">        return moyenPaiement;</span>
    }
    
    public void setMoyenPaiement(String moyenPaiement) {
<span class="nc" id="L136">        this.moyenPaiement = moyenPaiement;</span>
<span class="nc" id="L137">    }</span>
    
    /*@ pure @*/
    public String getStatutPaiement() {
<span class="fc" id="L141">        return statutPaiement;</span>
    }
    
    public void setStatutPaiement(String statutPaiement) {
<span class="nc" id="L145">        this.statutPaiement = statutPaiement;</span>
<span class="nc" id="L146">    }</span>
    
    /*@ pure @*/
    public double getPrixExtras() {
<span class="fc" id="L150">        return prixExtras;</span>
    }
    
    /*@ 
      @ requires prixExtras &gt;= 0.0;
      @ assignable this.prixExtras;
      @ ensures this.prixExtras == prixExtras;
      @*/
    public void setPrixExtras(double prixExtras) {
<span class="fc" id="L159">        this.prixExtras = prixExtras;</span>
<span class="fc" id="L160">    }</span>
    
    /*@ pure @*/
    public DossierMedicale getDossierMedicale() {
<span class="fc" id="L164">        return dossierMedicale;</span>
    }
    
    /*@ 
      @ ensures this.dossierMedicale == dossierMedicale;
      @*/
    public void setDossierMedicale(DossierMedicale dossierMedicale) {
<span class="fc" id="L171">        this.dossierMedicale = dossierMedicale;</span>
        
        // Ensure bi-directional relationship
<span class="pc bpc" id="L174" title="1 of 4 branches missed.">        if (dossierMedicale != null &amp;&amp; !dossierMedicale.getSejours().contains(this)) {</span>
<span class="fc" id="L175">            dossierMedicale.addSejour(this);</span>
        }
<span class="fc" id="L177">    }</span>
    
    // Transient getters and setters (not in database)
    /*@ pure @*/
    public String getChambre() {
<span class="fc" id="L182">        return chambre;</span>
    }
    
    public void setChambre(String chambre) {
<span class="fc" id="L186">        this.chambre = chambre;</span>
<span class="fc" id="L187">    }</span>
    
    /*@ pure @*/
    public String getNotes() {
<span class="fc" id="L191">        return notes;</span>
    }
    
    public void setNotes(String notes) {
<span class="fc" id="L195">        this.notes = notes;</span>
<span class="fc" id="L196">    }</span>
    
    // Helper method to get dossier_medicale_id for database operations
    /*@ pure @*/
    public int getDossierMedicaleId() {
<span class="fc bfc" id="L201" title="All 2 branches covered.">        return dossierMedicale != null ? dossierMedicale.getId() : 0;</span>
    }
    
    /**
     * Calculate the total cost of the stay including base cost and extras
     * @return The total cost
     */
    /*@ 
      @ ensures \result == fraisSejour + prixExtras;
      @ ensures \result &gt;= 0.0;
      @ pure
      @*/
    public double calculateTotalCost() {
<span class="fc" id="L214">        return fraisSejour + prixExtras;</span>
    }
    
    /**
     * Calculate the duration of the stay in days
     * @return The number of days of the stay
     */
    /*@ 
      @ ensures (dateEntree == null || dateSortie == null) ==&gt; \result == 0;
      @ pure
      @*/
    public long calculateStayDuration() {
<span class="fc bfc" id="L226" title="All 4 branches covered.">        if (dateEntree == null || dateSortie == null) {</span>
<span class="fc" id="L227">            return 0;</span>
        }
        
<span class="fc" id="L230">        LocalDate dateIn = dateEntree.toLocalDate();</span>
<span class="fc" id="L231">        LocalDate dateOut = dateSortie.toLocalDate();</span>
<span class="fc" id="L232">        return ChronoUnit.DAYS.between(dateIn, dateOut);</span>
    }
    
    @Override
    public String toString() {
<span class="fc" id="L237">        return &quot;Séjour #&quot; + id + &quot; - &quot; + typeSejour + </span>
<span class="pc bpc" id="L238" title="1 of 2 branches missed.">               &quot; (&quot; + (dateEntree != null ? dateEntree.toLocalDate() : &quot;N/A&quot;) + </span>
<span class="pc bpc" id="L239" title="1 of 2 branches missed.">               &quot; à &quot; + (dateSortie != null ? dateSortie.toLocalDate() : &quot;N/A&quot;) + &quot;)&quot;;</span>
    }
} 
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>