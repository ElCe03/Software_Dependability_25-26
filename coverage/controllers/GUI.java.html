<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>GUI.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">roar</a> &gt; <a href="index.source.html" class="el_package">controllers</a> &gt; <span class="el_source">GUI.java</span></div><h1>GUI.java</h1><pre class="source lang-java linenums">package controllers;

import javafx.collections.FXCollections;
import javafx.collections.ObservableList;
import javafx.fxml.FXML;
import javafx.scene.control.*;
import javafx.scene.control.cell.PropertyValueFactory;
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;
import java.util.*;
import java.util.stream.Collectors;
import javafx.event.ActionEvent;
import javafx.fxml.FXMLLoader;
import javafx.scene.Node;
import javafx.scene.Parent;
import javafx.scene.Scene;
import javafx.stage.Stage;
import java.io.IOException;

<span class="nc" id="L20">public class GUI {</span>
    // Symptom Inputs
    @FXML private ComboBox&lt;String&gt; feverCombo, coughCombo, fatigueCombo, breathingCombo;
    @FXML private ComboBox&lt;String&gt; ageCombo, genderCombo, bpCombo, cholesterolCombo;

    // Results Display
    @FXML private Label result;
    @FXML private TableView&lt;Prediction&gt; historyTable;
    @FXML private TableColumn&lt;Prediction, String&gt; timeColumn;
    @FXML private TableColumn&lt;Prediction, String&gt; diseaseColumn;
    @FXML private TableColumn&lt;Prediction, Double&gt; confidenceColumn;
    @FXML private TableColumn&lt;Prediction, String&gt; symptomsColumn;
    @FXML private Button calculateButton;

<span class="nc" id="L34">    private Core core = new Core();</span>
<span class="nc" id="L35">    private ObservableList&lt;Prediction&gt; predictionHistory = FXCollections.observableArrayList();</span>

    public static class Prediction {
        private final String time;
        private final String disease;
        private final double confidence;
        private final String symptoms;

<span class="nc" id="L43">        public Prediction(String time, String disease, double confidence, String symptoms) {</span>
<span class="nc" id="L44">            this.time = time;</span>
<span class="nc" id="L45">            this.disease = disease;</span>
<span class="nc" id="L46">            this.confidence = confidence;</span>
<span class="nc" id="L47">            this.symptoms = symptoms;</span>
<span class="nc" id="L48">        }</span>

<span class="nc" id="L50">        public String getTime() { return time; }</span>
<span class="nc" id="L51">        public String getDisease() { return disease; }</span>
<span class="nc" id="L52">        public double getConfidence() { return confidence; }</span>
<span class="nc" id="L53">        public String getSymptoms() { return symptoms; }</span>
    }

    @FXML
    private void initialize() {
        // Setup symptom combo boxes
<span class="nc" id="L59">        ObservableList&lt;String&gt; yesNoOptions = FXCollections.observableArrayList(&quot;Yes&quot;, &quot;No&quot;, &quot;Unknown&quot;);</span>
<span class="nc" id="L60">        feverCombo.setItems(yesNoOptions);</span>
<span class="nc" id="L61">        feverCombo.setPromptText(&quot;Fever&quot;);</span>
<span class="nc" id="L62">        coughCombo.setItems(yesNoOptions);</span>
<span class="nc" id="L63">        coughCombo.setPromptText(&quot;Cough&quot;);</span>
<span class="nc" id="L64">        fatigueCombo.setItems(yesNoOptions);</span>
<span class="nc" id="L65">        fatigueCombo.setPromptText(&quot;Fatigue&quot;);</span>
<span class="nc" id="L66">        breathingCombo.setItems(yesNoOptions);</span>
<span class="nc" id="L67">        breathingCombo.setPromptText(&quot;Breathing Difficulty&quot;);</span>

        // Setup patient profile inputs
<span class="nc" id="L70">        ObservableList&lt;String&gt; ageGroups = FXCollections.observableArrayList(</span>
                &quot;Under 20&quot;, &quot;20-29&quot;, &quot;30-39&quot;, &quot;40-49&quot;, &quot;50-59&quot;, &quot;60-69&quot;, &quot;70+&quot;);
<span class="nc" id="L72">        ageCombo.setItems(ageGroups);</span>
<span class="nc" id="L73">        ageCombo.setPromptText(&quot;Age Group&quot;);</span>

<span class="nc" id="L75">        ObservableList&lt;String&gt; genders = FXCollections.observableArrayList(&quot;Male&quot;, &quot;Female&quot;, &quot;Other&quot;);</span>
<span class="nc" id="L76">        genderCombo.setItems(genders);</span>
<span class="nc" id="L77">        genderCombo.setPromptText(&quot;Gender&quot;);</span>

<span class="nc" id="L79">        ObservableList&lt;String&gt; bpLevels = FXCollections.observableArrayList(</span>
                &quot;Normal&quot;, &quot;Elevated&quot;, &quot;High&quot;, &quot;Very High&quot;);
<span class="nc" id="L81">        bpCombo.setItems(bpLevels);</span>
<span class="nc" id="L82">        bpCombo.setPromptText(&quot;Blood Pressure&quot;);</span>

<span class="nc" id="L84">        ObservableList&lt;String&gt; cholesterolLevels = FXCollections.observableArrayList(</span>
                &quot;Normal&quot;, &quot;Borderline High&quot;, &quot;High&quot;, &quot;Very High&quot;);
<span class="nc" id="L86">        cholesterolCombo.setItems(cholesterolLevels);</span>
<span class="nc" id="L87">        cholesterolCombo.setPromptText(&quot;Cholesterol Level&quot;);</span>

        // Setup TableView
<span class="nc" id="L90">        timeColumn.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;time&quot;));</span>
<span class="nc" id="L91">        diseaseColumn.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;disease&quot;));</span>
<span class="nc" id="L92">        confidenceColumn.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;confidence&quot;));</span>
<span class="nc" id="L93">        symptomsColumn.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;symptoms&quot;));</span>
<span class="nc" id="L94">        historyTable.setItems(predictionHistory);</span>

        // Style button
<span class="nc" id="L97">        calculateButton.setStyle(&quot;-fx-background-color: #4CAF50; -fx-text-fill: white; -fx-font-weight: bold;&quot;);</span>
<span class="nc" id="L98">    }</span>

    @FXML
    private void calculate() {
        try {
<span class="nc" id="L103">            Map&lt;String, String&gt; inputSymptoms = new HashMap&lt;&gt;();</span>

            // Collect all symptom inputs
<span class="nc bnc" id="L106" title="All 2 branches missed.">            if (feverCombo.getValue() != null)</span>
<span class="nc" id="L107">                inputSymptoms.put(&quot;Fever&quot;, feverCombo.getValue());</span>
<span class="nc bnc" id="L108" title="All 2 branches missed.">            if (coughCombo.getValue() != null)</span>
<span class="nc" id="L109">                inputSymptoms.put(&quot;Cough&quot;, coughCombo.getValue());</span>
<span class="nc bnc" id="L110" title="All 2 branches missed.">            if (fatigueCombo.getValue() != null)</span>
<span class="nc" id="L111">                inputSymptoms.put(&quot;Fatigue&quot;, fatigueCombo.getValue());</span>
<span class="nc bnc" id="L112" title="All 2 branches missed.">            if (breathingCombo.getValue() != null)</span>
<span class="nc" id="L113">                inputSymptoms.put(&quot;Difficulty Breathing&quot;, breathingCombo.getValue());</span>
<span class="nc bnc" id="L114" title="All 2 branches missed.">            if (ageCombo.getValue() != null)</span>
<span class="nc" id="L115">                inputSymptoms.put(&quot;Age&quot;, ageCombo.getValue());</span>
<span class="nc bnc" id="L116" title="All 2 branches missed.">            if (genderCombo.getValue() != null)</span>
<span class="nc" id="L117">                inputSymptoms.put(&quot;Gender&quot;, genderCombo.getValue());</span>
<span class="nc bnc" id="L118" title="All 2 branches missed.">            if (bpCombo.getValue() != null)</span>
<span class="nc" id="L119">                inputSymptoms.put(&quot;Blood Pressure&quot;, bpCombo.getValue());</span>
<span class="nc bnc" id="L120" title="All 2 branches missed.">            if (cholesterolCombo.getValue() != null)</span>
<span class="nc" id="L121">                inputSymptoms.put(&quot;Cholesterol Level&quot;, cholesterolCombo.getValue());</span>

<span class="nc bnc" id="L123" title="All 2 branches missed.">            if (inputSymptoms.isEmpty()) {</span>
<span class="nc" id="L124">                showError(&quot;Please select at least one symptom&quot;);</span>
<span class="nc" id="L125">                return;</span>
            }

<span class="nc" id="L128">            Map&lt;String, Double&gt; probabilities = core.predict(inputSymptoms);</span>

<span class="nc bnc" id="L130" title="All 2 branches missed.">            if (probabilities.isEmpty()) {</span>
<span class="nc" id="L131">                showError(&quot;No matching diseases found for these symptoms&quot;);</span>
<span class="nc" id="L132">                return;</span>
            }

<span class="nc" id="L135">            displayResults(probabilities, inputSymptoms);</span>

<span class="nc" id="L137">        } catch (Exception e) {</span>
<span class="nc" id="L138">            showError(&quot;Error: &quot; + e.getMessage());</span>
<span class="nc" id="L139">            e.printStackTrace();</span>
<span class="nc" id="L140">        }</span>
<span class="nc" id="L141">    }</span>

    private void displayResults(Map&lt;String, Double&gt; probabilities, Map&lt;String, String&gt; inputs) {
        // Get top 3 predictions
<span class="nc" id="L145">        List&lt;Map.Entry&lt;String, Double&gt;&gt; topPredictions = probabilities.entrySet().stream()</span>
<span class="nc" id="L146">                .sorted(Map.Entry.&lt;String, Double&gt;comparingByValue().reversed())</span>
<span class="nc" id="L147">                .limit(3)</span>
<span class="nc" id="L148">                .collect(Collectors.toList());</span>

        // Format results
<span class="nc" id="L151">        StringBuilder resultText = new StringBuilder(&quot;Top Predictions:\n&quot;);</span>
<span class="nc bnc" id="L152" title="All 2 branches missed.">        for (Map.Entry&lt;String, Double&gt; entry : topPredictions) {</span>
<span class="nc" id="L153">            resultText.append(String.format(&quot;- %s (%.1f%%)\n&quot;, entry.getKey(), entry.getValue()));</span>
<span class="nc" id="L154">        }</span>

<span class="nc" id="L156">        result.setText(resultText.toString());</span>
<span class="nc" id="L157">        result.setStyle(&quot;-fx-text-fill: black;&quot;);</span>

        // Add to history
<span class="nc" id="L160">        String symptomInput = inputs.entrySet().stream()</span>
<span class="nc" id="L161">                .map(e -&gt; e.getKey() + &quot;: &quot; + e.getValue())</span>
<span class="nc" id="L162">                .collect(Collectors.joining(&quot;, &quot;));</span>

<span class="nc" id="L164">        predictionHistory.add(new Prediction(</span>
<span class="nc" id="L165">                LocalDateTime.now().format(DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ss&quot;)),</span>
<span class="nc" id="L166">                topPredictions.get(0).getKey(),</span>
<span class="nc" id="L167">                topPredictions.get(0).getValue(),</span>
                symptomInput));
<span class="nc" id="L169">    }</span>

    private void showError(String message) {
<span class="nc" id="L172">        result.setText(message);</span>
<span class="nc" id="L173">        result.setStyle(&quot;-fx-text-fill: red;&quot;);</span>
<span class="nc" id="L174">    }</span>
    @FXML
    private void goToFront(ActionEvent event) throws IOException {
<span class="nc" id="L177">        Parent root = FXMLLoader.load(getClass().getResource(&quot;/front.fxml&quot;));</span>
<span class="nc" id="L178">        Stage stage = (Stage)((Node)event.getSource()).getScene().getWindow();</span>
<span class="nc" id="L179">        stage.setScene(new Scene(root));</span>
<span class="nc" id="L180">        stage.show();</span>
<span class="nc" id="L181">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>